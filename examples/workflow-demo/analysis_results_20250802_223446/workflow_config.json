{
  "name": "multi-url-analysis-3-articles",
  "description": "Analyze 3 web articles in parallel",
  "config": {
    "max_parallel": 3,
    "timeout": "30m",
    "failure_strategy": "continue_on_partial"
  },
  "steps": [
    {
      "id": "prepare",
      "name": "Prepare URLs",
      "type": "sequential",
      "config": {
        "image": "doc-extractor:latest",
        "command": [
          "python",
          "app_multi.py"
        ],
        "env": {
          "TASK_TYPE": "prepare_urls",
          "URL_COUNT": "3"
        },
        "resource_limits": {
          "cpu_limit": 500000000,
          "memory_limit": 268435456
        }
      }
    },
    {
      "id": "process",
      "name": "Process URLs in Parallel",
      "type": "map",
      "depends_on": [
        "prepare"
      ],
      "config": {
        "image": "doc-extractor:latest",
        "command": [
          "python",
          "app_multi.py"
        ],
        "env": {
          "TASK_TYPE": "process_url"
        },
        "map_config": {
          "input_path": "urls",
          "item_alias": "current_url",
          "max_concurrency": 3,
          "error_handling": "continue_on_error"
        },
        "resource_limits": {
          "cpu_limit": 250000000,
          "memory_limit": 268435456
        }
      }
    },
    {
      "id": "aggregate",
      "name": "Aggregate Results",
      "type": "reduce",
      "depends_on": [
        "process"
      ],
      "config": {
        "image": "doc-extractor:latest",
        "command": [
          "python",
          "app_multi.py"
        ],
        "env": {
          "TASK_TYPE": "aggregate"
        },
        "resource_limits": {
          "cpu_limit": 500000000,
          "memory_limit": 268435456
        }
      }
    },
    {
      "id": "entities",
      "name": "Extract Entities with AI",
      "type": "sequential",
      "depends_on": [
        "aggregate"
      ],
      "config": {
        "image": "gemini-workflow-agent:latest",
        "command": [
          "python",
          "app.py"
        ],
        "env": {
          "TASK_TYPE": "extract_entities_multi"
        },
        "resource_limits": {
          "cpu_limit": 1000000000,
          "memory_limit": 1073741824
        }
      }
    },
    {
      "id": "insights",
      "name": "Generate Cross-Article Insights",
      "type": "sequential",
      "depends_on": [
        "entities"
      ],
      "config": {
        "image": "gpt-workflow-agent:latest",
        "command": [
          "python",
          "app.py"
        ],
        "env": {
          "TASK_TYPE": "generate_insights_multi"
        },
        "resource_limits": {
          "cpu_limit": 1000000000,
          "memory_limit": 1073741824
        }
      }
    },
    {
      "id": "report",
      "name": "Create Comprehensive Report",
      "type": "sequential",
      "depends_on": [
        "insights"
      ],
      "config": {
        "image": "gemini-workflow-agent:latest",
        "command": [
          "python",
          "app.py"
        ],
        "env": {
          "TASK_TYPE": "final_report_multi"
        },
        "resource_limits": {
          "cpu_limit": 1000000000,
          "memory_limit": 1073741824
        }
      }
    }
  ]
}